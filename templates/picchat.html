<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pic Chat</title>
    
    <!-- Google Consent Mode -->
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      
      gtag('consent', 'default', {
        'ad_storage': 'denied',
        'ad_user_data': 'denied',
        'ad_personalization': 'denied',
        'analytics_storage': 'denied'
      });
    </script>
    
    <!-- Google Funding Choices (Consent Management Platform) -->
    <script async src="https://fundingchoicesmessages.google.com/i/pub-5356065806901786?ers=1" nonce="NONCE"></script>
    <script nonce="NONCE">(function() {function signalGooglefcPresent() {if (!window.frames['googlefcPresent']) {if (document.body) {const iframe = document.createElement('iframe'); iframe.style = 'width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;'; iframe.style.display = 'none'; iframe.name = 'googlefcPresent'; document.body.appendChild(iframe);} else {setTimeout(signalGooglefcPresent, 0);}}}signalGooglefcPresent();})();</script>
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5356065806901786"
     crossorigin="anonymous"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/picchat.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/pixel.css') }}"
    />
  </head>
  <body>
    <a href="javascript:history.back()">
      <img
        class="back-button"
        src="{{ url_for('static', filename='images/back-button.png') }}"
        alt="back-button"
      />
    </a>
    <h1>Pic Chat</h1>
    <video id="video" width="320" height="240" autoplay playsinline></video>
    <br />
    <button id="pic-btn">Analyze Pic</button>
    <div id="loader" style="display: none; text-align: center; margin-top: 1em">
      <span class="pixel-loader"></span>
      <span style="font-family: inherit">Analyzing...</span>
    </div>
    <div id="pic-result" style="margin-top: 1em"></div>
    <button id="start-chat-btn" style="display: none; margin: 1em auto">
      Start Chat
    </button>
    <script src="{{ url_for('static', filename='js/picchat.js') }}"></script>
    <script>
      // Start webcam
      navigator.mediaDevices.getUserMedia({ video: true }).then((stream) => {
        document.getElementById("video").srcObject = stream;
      });
    </script>
  </body>
</html>
